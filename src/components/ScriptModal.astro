<script>
  const contactoEnlaces = document.querySelectorAll('a[href="#contacto"]');
  const modal = document.getElementById("modal-contacto");
  const modalContent = modal ? modal.querySelector(".modal-content") : null;
  const cerrarBotones = [
    document.getElementById("cerrar-modal-contacto"),
    document.getElementById("cerrar-modal-contacto2"),
  ];

  const button = document.getElementById('menu-button');
  const menu = document.getElementById('mobile-menu');
  const icon = document.getElementById('menu-icon');

  let modalAbierto = false;

  function abrirModal() {
    if (!modalAbierto && modal && modalContent) {
      modal.classList.remove("hidden");
      modal.classList.add("flex");

      // fuerza reflow para que se apliquen las clases siguientes con animaciÃ³n
      void modal.offsetWidth;

      modal.classList.remove("opacity-0");
      modal.classList.add("opacity-100");

      modalContent.classList.remove("-translate-y-10", "opacity-0");
      modalContent.classList.add("translate-y-0", "opacity-100");

      modalAbierto = true;
      if (menu) {
        menu.classList.remove('max-h-96', 'opacity-100');
        menu.classList.add('max-h-0', 'opacity-0');
      }

        if (icon) {
          icon.classList.remove('rotate-90');
        }
        if (button) {
          button.setAttribute('aria-expanded', 'false');
          //wait 0.2 seconds before removing the background color
          setTimeout(() => {
            button.classList.remove('bg-gray-900');
          }, 200);
          //add transition to the button background color
          button.classList.add('transition-colors', 'duration-700');
        }
    } else {
      cerrarModal();
    }
  }

  export function cerrarModal() {
    if (modal && modalContent) {
      modal.classList.remove("opacity-100");
      modal.classList.add("opacity-0");

      modalContent.classList.remove("translate-y-0", "opacity-100");
      modalContent.classList.add("-translate-y-10", "opacity-0");

      setTimeout(() => {
        modal.classList.remove("flex");
        modal.classList.add("hidden");
        modalAbierto = false;
      }, 300);
    }
  }

  contactoEnlaces.forEach((el) =>
    el.addEventListener("click", (e) => {
      e.preventDefault();
      abrirModal();
    })
  );

  cerrarBotones.forEach((btn) => {
    if (btn) btn.addEventListener("click", cerrarModal);
  });

  if (modal) {
    modal.addEventListener("click", (e) => {
      if (e.target === modal) cerrarModal();
    });
  }
</script>
